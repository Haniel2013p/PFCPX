<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sistema PF - RP</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 0;
    background: #f0f2f5;
  }
  header {
    background: #004080;
    color: white;
    padding: 15px;
    text-align: center;
  }
  #dashboard-publico, #login-section, #app-section {
    max-width: 700px;
    margin: 30px auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 8px #ccc;
  }
  h2 {
    color: #004080;
    margin-bottom: 15px;
  }
  label {
    display: block;
    margin: 8px 0 4px;
  }
  input[type=text], input[type=password], select, textarea {
    width: 100%;
    padding: 8px;
    border-radius: 4px;
    border: 1px solid #aaa;
    box-sizing: border-box;
  }
  button {
    margin-top: 15px;
    padding: 10px 20px;
    background: #004080;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover { background: #003060; }
  .hidden { display: none; }
  nav {
    margin-bottom: 20px;
  }
  nav button {
    margin-right: 10px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }
  th, td {
    padding: 8px;
    border: 1px solid #ddd;
    word-break: break-word;
  }
  th {
    background: #004080;
    color: white;
  }
  .error { color: red; margin-top: 10px; }
</style>
</head>
<body>

<header>
  <h1>Sistema Polícia Federal (RP)</h1>
</header>

<!-- Dashboard público -->
<section id="dashboard-publico">
  <h2>Bem-vindo ao Painel Público</h2>
  <p>Este painel é de uso público a cidadãos do complexo. Aqui pode ser efetuado registro de Boletins de Ocorrência (B.O) e revisão das portarias de acesso público.</p>
  
  <button onclick="mostrarPainelPublico('painelBOPublico')">Registrar B.O Público</button>
  <button onclick="mostrarPainelPublico('painelPortariasPublicas')">Ver Portarias Públicas</button>
  <button onclick="mostrarLogin()">Iniciar Sessão (Usuários Registrados)</button>

  <div id="avisosPublicos" style="margin-top:20px; border:1px solid #004080; padding:10px; border-radius:5px; background:#e6f0ff;">
    <h3>Avisos Públicos</h3>
    <ul id="listaAvisosPublicos">
      <!-- Avisos dinâmicos aqui -->
    </ul>
  </div>

  <div id="painelBOPublico" class="hidden" style="margin-top:20px;">
    <h3>Registrar Boletim de Ocorrência (Público)</h3>
    <form id="formBOPublico">
      <label for="tituloBOPublico">Título do BO:</label>
      <input type="text" id="tituloBOPublico" required />
      <label for="descricaoBOPublico">Descrição:</label>
      <textarea id="descricaoBOPublico" rows="4" required></textarea>
      <label for="denunciadoBOPublico">Pessoa Denunciada (nome):</label>
      <input type="text" id="denunciadoBOPublico" required />
      <button type="submit">Registrar B.O</button>
    </form>
    <h3>Boletins Públicos Registrados</h3>
    <table id="tabelaBOPublico">
      <thead>
        <tr><th>Título</th><th>Descrição</th><th>Denunciado</th><th>Data</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="painelPortariasPublicas" class="hidden" style="margin-top:20px;">
    <h3>Portarias Públicas</h3>
    <ul id="listaPortariasPublicas"></ul>
  </div>
</section>

<!-- Login -->
<section id="login-section" class="hidden">
  <h2>Login</h2>
  <form id="loginForm">
    <label for="username">Usuário:</label>
    <input type="text" id="username" required autocomplete="off" />
    <label for="password">Senha:</label>
    <input type="password" id="password" required autocomplete="off" />
    <button type="submit">Entrar</button>
  </form>
  <div id="login-error" class="error"></div>
  <button onclick="mostrarDashboardPublico()">Voltar ao Público</button>
</section>

<!-- Área restrita -->
<section id="app-section" class="hidden">
  <nav>
    <button onclick="mostrarPainel('painelPromocoes')">Painel Promoções</button>
    <button onclick="mostrarPainel('painelBancoCriminal')">Banco Criminal</button>
    <button onclick="mostrarPainel('painelPortariasInternas')">Portarias (Delegado+)</button>
    <button onclick="mostrarPainel('painelRegistroMembros')">Registrar Membros (Diretor+)</button>
    <button onclick="logout()">Sair</button>
  </nav>

  <!-- Painel Promoções -->
  <div id="painelPromocoes" class="painel">
    <h2>Painel de Promoção / Rebaixamento / Exoneração</h2>
    <table id="usuariosTable">
      <thead>
        <tr><th>Usuário</th><th>Cargo</th><th>Ações</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Banco Criminal -->
  <div id="painelBancoCriminal" class="painel hidden">
    <h2>Registro Banco Criminal</h2>
    <form id="formBancoCriminal">
      <label for="nomeCriminoso">Nome do Criminoso:</label>
      <input type="text" id="nomeCriminoso" required />
      <label for="tipoCrime">Tipo do Crime:</label>
      <input type="text" id="tipoCrime" required />
      <label for="descricaoCrime">Descrição do Crime:</label>
      <textarea id="descricaoCrime" rows="4" required></textarea>
      <button type="submit">Registrar Crime</button>
    </form>
    <h3>Crimes Registrados</h3>
    <table id="tabelaBancoCriminal">
      <thead>
        <tr><th>Nome</th><th>Tipo</th><th>Descrição</th><th>Data</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Portarias internas -->
  <div id="painelPortariasInternas" class="painel hidden">
    <h2>Gerenciar Portarias</h2>
    <form id="formPortaria">
      <label for="tituloPortaria">Título da Portaria:</label>
      <input type="text" id="tituloPortaria" required />
      <label for="conteudoPortaria">Conteúdo:</label>
      <textarea id="conteudoPortaria" rows="4" required></textarea>
      <button type="submit">Criar Portaria</button>
    </form>
    <h3>Portarias Internas Criadas</h3>
    <ul id="listaPortariasInternas"></ul>
  </div>

  <!-- Registro de membros -->
  <div id="painelRegistroMembros" class="painel hidden">
    <h2>Registrar Novo Membro (Diretor+)</h2>
    <form id="formRegistroMembros">
      <label for="novoUsuario">Usuário (login):</label>
      <input type="text" id="novoUsuario" required autocomplete="off" />
      <label for="novaSenha">Senha:</label>
      <input type="password" id="novaSenha" required />
      <label for="cargoInicial">Cargo Inicial:</label>
      <select id="cargoInicial" required>
        <option value="" disabled selected>Selecione um cargo</option>
        <option value="Agente">Agente</option>
        <option value="Escrivão">Escrivão</option>
        <option value="Investigador">Investigador</option>
        <option value="Delegado">Delegado</option>
        <option value="Diretor">Diretor</option>
      </select>
      <button type="submit">Registrar Membro</button>
    </form>
  </div>
</section>

<script>
  // Dados simulados / banco local
  let usuarios = [
    { usuario: 'admin', senha: 'admin123', cargo: 'Diretor' },
    { usuario: 'delegado1', senha: 'senha123', cargo: 'Delegado' },
    { usuario: 'agente1', senha: 'senha123', cargo: 'Agente' },
  ];

  let boletinsPublicos = [];
  let portariasPublicas = [
    "Portaria 001: Uso obrigatório de crachá nas dependências.",
    "Portaria 002: Restrição de acesso após as 22h.",
  ];
  let portariasInternas = [];
  let bancoCriminal = [];

  let usuarioLogado = null;

  // Funções para mostrar/ocultar painéis
  function mostrarDashboardPublico() {
    document.getElementById('dashboard-publico').classList.remove('hidden');
        document.getElementById('login-section').classList.add('hidden');
    document.getElementById('app-section').classList.add('hidden');
    limparMensagensLogin();
    mostrarPainelPublico(''); // Oculta painéis específicos
  }

  function mostrarLogin() {
    document.getElementById('dashboard-publico').classList.add('hidden');
    document.getElementById('login-section').classList.remove('hidden');
    document.getElementById('app-section').classList.add('hidden');
    limparMensagensLogin();
  }

  function mostrarPainelPublico(painelId) {
    const paineis = ['painelBOPublico', 'painelPortariasPublicas'];
    paineis.forEach(id => {
      const el = document.getElementById(id);
      if (id === painelId) el.classList.remove('hidden');
      else el.classList.add('hidden');
    });
  }

  function mostrarPainel(painelId) {
    const paineis = ['painelPromocoes', 'painelBancoCriminal', 'painelPortariasInternas', 'painelRegistroMembros'];
    paineis.forEach(id => {
      const el = document.getElementById(id);
      if (id === painelId) el.classList.remove('hidden');
      else el.classList.add('hidden');
    });
  }

  // Limpar mensagem de erro de login
  function limparMensagensLogin() {
    document.getElementById('login-error').textContent = '';
  }

  // Login
  document.getElementById('loginForm').addEventListener('submit', function(event){
    event.preventDefault();
    const user = document.getElementById('username').value.trim();
    const pass = document.getElementById('password').value;

    const usuarioEncontrado = usuarios.find(u => u.usuario === user && u.senha === pass);

    if (usuarioEncontrado) {
      usuarioLogado = usuarioEncontrado;
      carregarApp();
    } else {
      document.getElementById('login-error').textContent = 'Usuário ou senha incorretos.';
    }
  });

  // Logout
  function logout() {
    usuarioLogado = null;
    mostrarDashboardPublico();
  }

  // Carregar dados da área restrita após login
  function carregarApp() {
    document.getElementById('dashboard-publico').classList.add('hidden');
    document.getElementById('login-section').classList.add('hidden');
    document.getElementById('app-section').classList.remove('hidden');
    mostrarPainel('painelPromocoes');
    atualizarTabelaUsuarios();
    atualizarTabelaBancoCriminal();
    atualizarListaPortariasInternas();
  }

  // Atualizar tabela de usuários para promoções e rebaixamentos
  function atualizarTabelaUsuarios() {
    const tbody = document.querySelector('#usuariosTable tbody');
    tbody.innerHTML = '';
    usuarios.forEach((u, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${u.usuario}</td>
        <td>${u.cargo}</td>
        <td>
          <button onclick="alterarCargo(${i}, 'subir')">Promover</button>
          <button onclick="alterarCargo(${i}, 'descer')">Rebaixar</button>
          <button onclick="exonerarUsuario(${i})">Exonerar</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Ordem hierárquica para cargos
  const cargosOrdem = ['Agente', 'Escrivão', 'Investigador', 'Delegado', 'Diretor'];

  function alterarCargo(indice, acao) {
    const usuario = usuarios[indice];
    let cargoAtual = usuario.cargo;
    let pos = cargosOrdem.indexOf(cargoAtual);
    if (acao === 'subir' && pos < cargosOrdem.length - 1) {
      usuario.cargo = cargosOrdem[pos + 1];
      alert(`Usuário ${usuario.usuario} promovido para ${usuario.cargo}`);
    } else if (acao === 'descer' && pos > 0) {
      usuario.cargo = cargosOrdem[pos - 1];
      alert(`Usuário ${usuario.usuario} rebaixado para ${usuario.cargo}`);
    } else {
      alert('Operação inválida para o cargo atual.');
    }
    atualizarTabelaUsuarios();
  }

  function exonerarUsuario(indice) {
    const usuario = usuarios[indice];
    if (confirm(`Tem certeza que deseja exonerar o usuário ${usuario.usuario}?`)) {
      usuarios.splice(indice, 1);
      alert('Usuário exonerado com sucesso.');
      atualizarTabelaUsuarios();
    }
  }

  // Registrar novo membro
  document.getElementById('formRegistroMembros').addEventListener('submit', function(event){
    event.preventDefault();
    if (!usuarioLogado) return alert('Usuário não logado.');
    if (!['Diretor'].includes(usuarioLogado.cargo)) return alert('Somente Diretor pode registrar membros.');

    const novoUsuario = document.getElementById('novoUsuario').value.trim();
    const novaSenha = document.getElementById('novaSenha').value;
    const cargoInicial = document.getElementById('cargoInicial').value;

    if (usuarios.find(u => u.usuario === novoUsuario)) {
      alert('Usuário já existe.');
      return;
    }

    usuarios.push({usuario: novoUsuario, senha: novaSenha, cargo: cargoInicial});
    alert(`Usuário ${novoUsuario} registrado com sucesso.`);
    document.getElementById('formRegistroMembros').reset();
    atualizarTabelaUsuarios();
  });

  // Registrar boletim de ocorrência público
  document.getElementById('formBOPublico').addEventListener('submit', function(event){
    event.preventDefault();
    const titulo = document.getElementById('tituloBOPublico').value.trim();
    const descricao = document.getElementById('descricaoBOPublico').value.trim();
    const denunciado = document.getElementById('denunciadoBOPublico').value.trim();

    const dataAgora = new Date().toLocaleString();

    boletinsPublicos.push({titulo, descricao, denunciado, data: dataAgora});
    alert('B.O público registrado com sucesso.');

    document.getElementById('formBOPublico').reset();
    atualizarTabelaBOPublico();
  });

  function atualizarTabelaBOPublico() {
    const tbody = document.querySelector('#tabelaBOPublico tbody');
    tbody.innerHTML = '';
    boletinsPublicos.forEach(bo => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${bo.titulo}</td><td>${bo.descricao}</td><td>${bo.denunciado}</td><td>${bo.data}</td>`;
      tbody.appendChild(tr);
    });
  }

  // Atualizar lista de portarias públicas
  function atualizarListaPortariasPublicas() {
    const ul = document.getElementById('listaPortariasPublicas');
    ul.innerHTML = '';
    portariasPublicas.forEach(portaria => {
      const li = document.createElement('li');
      li.textContent = portaria;
      ul.appendChild(li);
    });
  }

  // Registrar crime no banco criminal
  document.getElementById('formBancoCriminal').addEventListener('submit', function(event){
    event.preventDefault();
    if (!usuarioLogado) return alert('Usuário não logado.');

    const nome = document.getElementById('nomeCriminoso').value.trim();
    const tipo = document.getElementById('tipoCrime').value.trim();
    const descricao = document.getElementById('descricaoCrime').value.trim();
    const dataAgora = new Date().toLocaleString();

    bancoCriminal.push({nome, tipo, descricao, data: dataAgora});
    alert('Crime registrado com sucesso.');

    document.getElementById('formBancoCriminal').reset();
    atualizarTabelaBancoCriminal();
  });

  function atualizarTabelaBancoCriminal() {
    const tbody = document.querySelector('#tabelaBancoCriminal tbody');
    tbody.innerHTML = '';
    bancoCriminal.forEach(crime => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${crime.nome}</td><td>${crime.tipo}</td><td>${crime.descricao}</td><td>${crime.data}</td>`;
      tbody.appendChild(tr);
    });
  }

  // Criar portaria interna
  document.getElementById('formPortaria').addEventListener('submit', function(event){
    event.preventDefault();
    if (!usuarioLogado) return alert('Usuário não logado.');
    if (!['Delegado','Diretor'].includes(usuarioLogado.cargo)) return alert('Somente Delegado ou Diretor pode criar portarias.');

    const titulo = document.getElementById('tituloPortaria').value.trim();
    const conteudo = document.getElementById('conteudoPortaria').value.trim();

    portariasInternas.push({titulo, conteudo});
    alert('Portaria criada com sucesso.');

    document.getElementById('formPortaria').reset();
    atualizarListaPortariasInternas();
  });

  function atualizarListaPortariasInternas() {
    const ul = document.getElementById('listaPortariasInternas');
    ul.innerHTML = '';
    portariasInternas.forEach(p => {
      const li = document.createElement('li');
      li.innerHTML = `<strong>${p.titulo}</strong>: ${p.conteudo}`;
      ul.appendChild(li);
    });
  }

  // Inicialização
  atualizarListaPortariasPublicas();
  atualizarTabelaBOPublico();
  mostrarDashboardPublico();
</script>

</body>
</html>
