<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel - Serviço Secreto Municipal</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #111; color: #eee; margin: 0; padding: 0; }
    .container { max-width: 800px; margin: 40px auto; background-color: #222; padding: 20px; border-radius: 10px; }
    h1, h2 { text-align: center; }
    input, select, button, textarea {
      display: block; width: 100%; margin: 10px 0; padding: 10px;
      background-color: #333; color: #fff; border: none; border-radius: 5px;
    }
    button { background-color: #007bff; cursor: pointer; }
    button:hover { background-color: #0056b3; }
    .hidden { display: none; }
    .top-bar { display: flex; justify-content: space-between; margin-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #444; padding: 8px; text-align: center; }
    .btn-small { font-size: 12px; padding: 5px; width: auto; display: inline-block; margin: 0 2px; }
  </style>
</head>
<body>
  <div class="container" id="loginContainer">
    <h1>Login - Serviço Secreto Municipal</h1>
    <input type="text" id="loginId" placeholder="Digite seu ID">
    <button onclick="login()">Entrar</button>
    <p>Não tem conta? <a href="#" onclick="toggleCadastro()">Cadastrar</a></p>
  </div>

  <div class="container hidden" id="cadastroContainer">
    <h1>Cadastro</h1>
    <input type="text" id="cadastroId" placeholder="ID">
    <input type="text" id="cadastroNome" placeholder="Nome">
    <select id="cadastroDivisao">
      <option value="Segurança">Segurança</option>
      <option value="Inteligência">Inteligência</option>
      <option value="Táticas">Táticas</option>
    </select>
    <button onclick="cadastrar()">Cadastrar</button>
  </div>

  <div class="container hidden" id="painelContainer">
    <div class="top-bar">
      <button onclick="mostrarLista()">Lista de registros</button>
      <button onclick="mostrarBancoCriminal()">Banco criminais</button>
    </div>
    <h2>Bem-vindo ao Serviço Secreto Municipal</h2>
    <p>Sistema interno para controle hierárquico e registros criminais.</p>
    <div id="listaUsuarios"></div>
  </div>

  <div class="container hidden" id="bancoCriminalContainer">
    <h2>Banco de Dados Criminais</h2>
    <input type="text" id="crimeNome" placeholder="Nome">
    <input type="text" id="crimeRG" placeholder="RG">
    <textarea id="crimeHistorico" placeholder="Histórico"></textarea>
    <select id="crimeStatus">
      <option>Em investigação</option>
      <option>Processo penal em andamento</option>
      <option>Fugitivo</option>
      <option>Em liberdade</option>
    </select>
    <select id="crimePreso">
      <option>Sim</option>
      <option>Não</option>
    </select>
    <button onclick="adicionarCrime()">Adicionar</button>

    <h3>Pesquisar por RG</h3>
    <input type="text" id="pesquisaRG" placeholder="Digite o RG">
    <button onclick="pesquisarCrime()">Pesquisar</button>

    <div id="resultadoPesquisa"></div>
  </div>

  <script>
    const patentes = {
      'Segurança': ['Estagiário', 'Agente', 'Supervisor de Segurança', 'Comandante de Segurança'],
      'Inteligência': ['Analista', 'Investigador', 'Agente Especial', 'Chefe de Inteligência'],
      'Táticas': ['Operador', 'Tático', 'Comando de Elite', 'Coordenador de Operações Táticas'],
      'Comando': ['Inspetor Geral', 'Diretor', 'VSSP', 'SSP', 'Administrador']
    };

    let usuarioLogado = null;

    function salvarUsuarios(usuarios) {
      localStorage.setItem("usuarios", JSON.stringify(usuarios));
    }

    function obterUsuarios() {
      return JSON.parse(localStorage.getItem("usuarios") || "[]");
    }

    function salvarCrimes(crimes) {
      localStorage.setItem("crimes", JSON.stringify(crimes));
    }

    function obterCrimes() {
      return JSON.parse(localStorage.getItem("crimes") || "[]");
    }

    function login() {
      const id = document.getElementById("loginId").value;
      const usuarios = obterUsuarios();
      const usuario = usuarios.find(u => u.id === id);
      if (usuario) {
        usuarioLogado = usuario;
        document.getElementById("loginContainer").classList.add("hidden");
        document.getElementById("painelContainer").classList.remove("hidden");
      } else {
        alert("ID não encontrado.");
      }
    }

    function toggleCadastro() {
      document.getElementById("loginContainer").classList.add("hidden");
      document.getElementById("cadastroContainer").classList.remove("hidden");
    }

    function cadastrar() {
      const id = document.getElementById("cadastroId").value;
      const nome = document.getElementById("cadastroNome").value;
      const divisao = document.getElementById("cadastroDivisao").value;
      const patenteInicial = patentes[divisao][0];
      const usuarios = obterUsuarios();
      if (usuarios.find(u => u.id === id)) {
        alert("ID já cadastrado.");
        return;
      }
      const novoUsuario = { id, nome, divisao, patente: patenteInicial };
      usuarios.push(novoUsuario);
      salvarUsuarios(usuarios);
      alert("Cadastro realizado com sucesso!");
      location.reload();
    }

    function mostrarLista() {
      const usuarios = obterUsuarios();
      let html = "<table><tr><th>ID</th><th>Nome</th><th>Divisão</th><th>Cargo</th><th>Ações</th></tr>";
      usuarios.forEach(u => {
        html += `<tr><td>${u.id}</td><td>${u.nome}</td><td>${u.divisao}</td><td>${u.patente}</td><td>
          <button class="btn-small" onclick="promover('${u.id}')">Promover</button>
          <button class="btn-small" onclick="rebaixar('${u.id}')">Rebaixar</button>
          <button class="btn-small" onclick="exonerar('${u.id}')">Exonerar</button></td></tr>`;
      });
      html += "</table>";
      document.getElementById("listaUsuarios").innerHTML = html;
    }

    function promover(id) {
      const usuarios = obterUsuarios();
      const alvo = usuarios.find(u => u.id === id);
      const hierarquia = patentes[alvo.divisao];
      const indice = hierarquia.indexOf(alvo.patente);
      if (indice < hierarquia.length - 1) {
        alvo.patente = hierarquia[indice + 1];
      } else if (alvo.divisao !== 'Comando') {
        alvo.divisao = 'Comando';
        alvo.patente = patentes['Comando'][0];
      }
      salvarUsuarios(usuarios);
      mostrarLista();
    }

    function rebaixar(id) {
      const usuarios = obterUsuarios();
      const alvo = usuarios.find(u => u.id === id);
      const hierarquia = patentes[alvo.divisao];
      const indice = hierarquia.indexOf(alvo.patente);
      if (indice > 0) {
        alvo.patente = hierarquia[indice - 1];
      } else {
        alert("Não é possível rebaixar mais.");
      }
      salvarUsuarios(usuarios);
      mostrarLista();
    }

    function exonerar(id) {
      if (!confirm("Deseja realmente exonerar este membro?")) return;
      let usuarios = obterUsuarios();
      usuarios = usuarios.filter(u => u.id !== id);
      salvarUsuarios(usuarios);
      mostrarLista();
    }

    function mostrarBancoCriminal() {
      document.getElementById("bancoCriminalContainer").classList.remove("hidden");
    }

    function adicionarCrime() {
      const nome = document.getElementById("crimeNome").value;
      const rg = document.getElementById("crimeRG").value;
      const historico = document.getElementById("crimeHistorico").value;
      const status = document.getElementById("crimeStatus").value;
      const foiPreso = document.getElementById("crimePreso").value;

      const totalPrisao = (status === "Em liberdade" && foiPreso === "Sim") ? 1 : 0;

      const crimes = obterCrimes();
      crimes.push({ nome, rg, historico, status, foiPreso, totalPrisao });
      salvarCrimes(crimes);
      alert("Registro adicionado!");
    }

    function pesquisarCrime() {
      const rg = document.getElementById("pesquisaRG").value;
      const crimes = obterCrimes().filter(c => c.rg === rg);
      if (crimes.length === 0) {
        document.getElementById("resultadoPesquisa").innerHTML = "Nenhum registro encontrado.";
        return;
      }
      let html = "<table><tr><th>Nome</th><th>RG</th><th>Histórico</th><th>Status</th><th>Foi Preso?</th><th>Total de Prisões</th></tr>";
      crimes.forEach(c => {
        html += `<tr><td>${c.nome}</td><td>${c.rg}</td><td>${c.historico}</td><td>${c.status}</td><td>${c.foiPreso}</td><td>${c.totalPrisao}</td></tr>`;
      });
      html += "</table>";
      document.getElementById("resultadoPesquisa").innerHTML = html;
    }
  </script>
</body>
</html>
