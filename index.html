<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Painel de Controle do Serviço Secreto Municipal</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #222;
      color: #eee;
      padding: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    h1 {
      color: #00ccff;
      margin-bottom: 30px;
    }
    input[type="text"], input[type="password"] {
      padding: 10px;
      font-size: 1.1em;
      border-radius: 5px;
      border: none;
      width: 250px;
      margin: 5px 0;
    }
    button {
      padding: 10px 20px;
      font-size: 1.1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
      background-color: #00ccff;
      color: #222;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #0099cc;
      color: white;
    }
    #resultado, #novo-jogador, #login {
      margin-top: 30px;
      background-color: #333;
      padding: 20px;
      border-radius: 8px;
      width: 350px;
      text-align: center;
    }
    #acoes button {
      width: 100px;
    }
    #btnToggleCadastro {
      font-size: 0.9em;
      color: #00ccff;
      background: none;
      border: none;
      cursor: pointer;
      margin-top: 10px;
      text-decoration: underline;
    }
    #user-info {
      position: fixed;
      top: 10px;
      right: 10px;
      background-color: #333;
      padding: 10px 20px;
      border-radius: 8px;
      display: none;
      color: #00ccff;
      font-weight: bold;
      user-select: none;
    }
    #btnLista {
      position: fixed;
      top: 10px;
      left: 10px;
      background-color: #00ccff;
      color: #000;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
    }
    #listaRegistros {
      display: none;
      background-color: #333;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
      width: 400px;
      text-align: left;
    }
    #pesquisa input {
      padding: 10px;
      font-size: 1.1em;
      border-radius: 5px;
      border: none;
      width: 250px;
      margin-right: 10px;
    }
    #sobre {
      margin-top: 30px;
      background-color: #333;
      padding: 20px;
      border-radius: 8px;
      width: 500px;
      text-align: center;
    }
  </style>
</head>
<body>

<h1>Painel de Controle do Serviço Secreto Municipal</h1>

<!-- Botão de lista de registros -->
<button id="btnLista" onclick="mostrarLista()">Lista de registros</button>

<!-- Login -->
<div id="login">
  <input type="text" id="loginID" placeholder="Digite seu ID" />
  <input type="password" id="loginSenha" placeholder="Digite sua senha" />
  <button onclick="fazerLogin()">Entrar</button>
  <button id="btnToggleCadastro">Ou cadastre-se abaixo</button>
</div>

<!-- Cadastro -->
<div id="novo-jogador" style="display:none;">
  <h2>Adicionar Novo Jogador</h2>
  <input type="text" id="novoID" placeholder="Digite o novo ID" />
  <input type="text" id="novoNome" placeholder="Digite o nome" />
  <input type="password" id="novaSenha" placeholder="Digite a senha" />
  <button onclick="adicionarJogador()">Adicionar Jogador</button>
</div>

<!-- Mensagem sobre o serviço secreto -->
<div id="sobre" style="display:none;">
  <h2>Sobre o serviço secreto</h2>
  <p>O Serviço Secreto é um órgão de segurança da gestão Municipal do Complexo, pode atuar na segurança de funcionários públicos, juízes e secretários, mas trabalha de forma prioritária e intensa na segurança do Prefeito da cidade.</p>
</div>

<!-- Pesquisa jogador -->
<div id="pesquisa" style="display:none;">
  <input type="text" id="inputID" placeholder="Digite o ID do jogador" />
  <button onclick="pesquisar()">Pesquisar</button>
</div>

<!-- Resultado -->
<div id="resultado" style="display:none;">
  <p><strong>Nome:</strong> <span id="nome"></span></p>
  <p><strong>Cargo:</strong> <span id="cargo"></span></p>
  <div id="acoes">
    <button onclick="promover()">Promover</button>
    <button onclick="rebaixar()">Rebaixar</button>
    <button onclick="expulsar()">Expulsar</button>
  </div>
</div>

<!-- Lista de registros -->
<div id="listaRegistros"></div>

<!-- Info do usuário logado -->
<div id="user-info"></div>

<script>
const cargos = [
  "Estagiário",
  "Investigador operacional",
  "Agente especializado",
  "Inspetor",
  "Inspetor chefe",
  "Chefe de inteligência",
  "Vice Secretario de segurança Pública",
  "Secretario de segurança pública"
];

let jogadores = JSON.parse(localStorage.getItem('jogadores')) || {
  "1": { nome: "Rodrigo", cargo: "Inspetor chefe", senha: "RD" },
  "2": { nome: "Japa", cargo: "Inspetor", senha: "JP" },
  "3": { nome: "Haniel", cargo: "Vice Secretario de segurança Pública", senha: "Haniel" },
  "4": { nome: "Luis", cargo: "Estagiário", senha: "LS" }
};

let idAtual = null;
let idAtualSelecionado = null;

function salvarLocalStorage() {
  localStorage.setItem('jogadores', JSON.stringify(jogadores));
}

function fazerLogin() {
  const id = document.getElementById('loginID').value.trim();
  const senha = document.getElementById('loginSenha').value;

  if (!(id in jogadores)) {
    alert('ID não encontrado!');
    return;
  }
  if (jogadores[id].senha !== senha) {
    alert('Senha incorreta!');
    return;
  }

  idAtual = id;
  mostrarPainel();
}

function mostrarPainel() {
  document.getElementById('login').style.display = 'none';
  document.getElementById('novo-jogador').style.display = 'none';
  document.getElementById('pesquisa').style.display = 'block';
  document.getElementById('sobre').style.display = 'block';

  const userInfo = document.getElementById('user-info');
  userInfo.innerText = `Nome: ${jogadores[idAtual].nome} | Cargo: ${jogadores[idAtual].cargo}`;
  userInfo.style.display = 'block';
}

function pesquisar() {
  if (!idAtual) return;

  const id = document.getElementById('inputID').value.trim();
  const resultadoDiv = document.getElementById('resultado');

  if (!(id in jogadores)) {
    alert('Jogador não encontrado!');
    resultadoDiv.style.display = 'none';
    return;
  }

  if (!podeModificar(idAtual, id)) {
    atualizarExibicao(id);
    resultadoDiv.style.display = 'block';
    document.getElementById('acoes').style.display = 'none';
    return;
  }

  idAtualSelecionado = id;
  atualizarExibicao(id);
  resultadoDiv.style.display = 'block';
  document.getElementById('acoes').style.display = 'block';
}

function atualizarExibicao(id) {
  document.getElementById('nome').innerText = jogadores[id].nome;
  document.getElementById('cargo').innerText = jogadores[id].cargo;
}

function indiceCargo(cargo) {
  return cargos.indexOf(cargo);
}

function podeModificar(id1, id2) {
  return indiceCargo(jogadores[id1].cargo) > indiceCargo(jogadores[id2].cargo);
}

function promover() {
  if (!idAtualSelecionado) return;
  let atual = jogadores[idAtualSelecionado];
  let indAtual = indiceCargo(atual.cargo);
  let indUser = indiceCargo(jogadores[idAtual].cargo);

  if (indAtual + 1 >= indUser) {
    alert('Você não pode promover este jogador para o seu próprio cargo ou acima.');
    return;
  }

  jogadores[idAtualSelecionado].cargo = cargos[indAtual + 1];
  salvarLocalStorage();
  atualizarExibicao(idAtualSelecionado);
  alert(`${atual.nome} foi promovido para ${jogadores[idAtualSelecionado].cargo}`);
}

function rebaixar() {
  if (!idAtualSelecionado) return;
  let atual = jogadores[idAtualSelecionado];
  let indAtual = indiceCargo(atual.cargo);
  if (indAtual <= 0) {
    alert(`${atual.nome} já está no cargo mínimo`);
    return;
  }
  if (!podeModificar(idAtual, idAtualSelecionado)) {
    alert('Você não tem permissão');
    return;
  }

  jogadores[idAtualSelecionado].cargo = cargos[indAtual - 1];
  salvarLocalStorage();
  atualizarExibicao(idAtualSelecionado);
  alert(`${atual.nome} foi rebaixado para ${jogadores[idAtualSelecionado].cargo}`);
}

function expulsar() {
  if (!idAtualSelecionado) return;
  if (!podeModificar(idAtual, idAtualSelecionado)) {
    alert('Você não tem permissão');
    return;
  }

  let nome = jogadores[idAtualSelecionado].nome;
  delete jogadores[idAtualSelecionado];
  salvarLocalStorage();
  alert(`${nome} foi expulso`);
  document.getElementById('resultado').style.display = 'none';
  idAtualSelecionado = null;
}

function adicionarJogador() {
  const novoID = document.getElementById('novoID').value.trim();
  const novoNome = document.getElementById('novoNome').value.trim();
  const novaSenha = document.getElementById('novaSenha').value;

  if (!novoID || !novoNome || !novaSenha) {
    alert('Preencha todos os campos!');
    return;
  }

  if (novoID in jogadores) {
    alert('ID já existe!');
    return;
  }

  jogadores[novoID] = { nome: novoNome, cargo: cargos[0], senha: novaSenha };
  salvarLocalStorage();
  alert(`Jogador ${novoNome} adicionado com sucesso!`);
  document.getElementById('novoID').value = '';
  document.getElementById('novoNome').value = '';
  document.getElementById('novaSenha').value = '';
}

document.getElementById('btnToggleCadastro').addEventListener('click', () => {
  const cadastroDiv = document.getElementById('novo-jogador');
  cadastroDiv.style.display = cadastroDiv.style.display === 'none' ? 'block' : 'none';
});

function mostrarLista() {
  const listaDiv = document.getElementById('listaRegistros');
  let texto = "<h3>Lista de registros</h3><pre>Nome                | ID     | Cargo\n";
  texto += "------------------------------------------\n";
  for (const [id, dados] of Object.entries(jogadores)) {
    texto += `${dados.nome.padEnd(20)} | ${id.padEnd(6)} | ${dados.cargo}\n`;
  }
  texto += "</pre>";
  listaDiv.innerHTML = texto;
  listaDiv.style.display = 'block';
}
</script>

</body>
</html>
